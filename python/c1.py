import io
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np

# Данные (угол в радианах, расстояние в пикселях)
data = """-0.5931069572	104.2080251
-0.5843231693	104.1543326
-0.5754001662	102.8266138
-0.5657200862	101.4473386
-0.5500896729	100.6618721
-0.5413428825	100.1211766
-0.5303397303	98.55074835
-0.5209721723	97.2760248
-0.5084898847	96.09695625
-0.4972907275	95.36148331
-0.4869039245	93.98969358
-0.4754648541	92.66741606
-0.4643708043	91.88375809
-0.4531218609	90.85462289
-0.4377053132	90.51657307
-0.4283927587	88.90620057
-0.412518517	87.63168662
-0.3985650051	86.5166169
-0.3897506919	86.06719758
-0.3796336478	84.95366384
-0.3690546744	83.59724876
-0.3588857381	83.39139644
-0.3484583841	82.81681593
-0.3378894157	82.24430071
-0.3273401394	81.71176476
-0.3155292272	80.93245641
-0.3017710346	79.906195
-0.2858613744	79.58525303
-0.2705857577	78.73730056
-0.2606379936	78.70355773
-0.247415113	77.77126116
-0.2370463214	77.43142127
-0.2273454091	77.15082631
-0.2184387456	77.11882066
-0.2057356729	76.31267916
-0.1942994403	75.53806987
-0.1805768322	76.03453163
-0.1704161296	75.50869155
-0.159577153	75.17687477
-0.1435877817	74.18262937
-0.1296444695	74.37909653
-0.1203606683	73.83258088
-0.1071904275	73.85670247
-0.09266298329	73.58371083
-0.08258683819	73.26706286
-0.07145362471	73.24616031
-0.06192300936	73.49532298
-0.05131192444	73.22610532
-0.04229679849	72.95760755
-0.0248651305	72.939187
-0.01424472113	72.40597351
0.009289876353	73.13856712
0.02713023722	71.37664184
0.03617314967	72.14048794
0.05060557497	73.60876307
0.06830894096	73.08385595
0.08098111595	74.05108034
0.09315887325	74.05108034
0.1385330546	73.55142759
0.1718509375	74.80056818
0.1887410556	75.52648542
0.1987238732	75.77021182
0.2106108767	76.26475267
0.2199582068	76.27007932
0.2295581211	76.75651438
0.2382704073	77.26011261
0.2524875088	77.50645134
0.2649042198	77.75361728
0.2828407613	78.50159234
0.2948759758	79.75352657
0.3082946092	81.00347215
0.3192475327	81.25038461
0.3290932917	81.25038461
0.3385381012	82.25151974
0.3480985238	81.75611598
0.362077509	83.25150149
0.3708985098	84.00037202
0.3826825279	84.50036982
0.3928837295	85.50328941
0.4036891828	86.00036337
0.4140958051	87.00574694
0.4242416958	87.25573047
0.436244786	88.00568163
0.4466781298	88.75880238
0.4557012567	89.50558642
0.4648936816	90.02812061
0.4740144347	90.76687171
0.4837897442	91.52185531"""

# Загрузка данных
df = pd.read_csv(io.StringIO(data), sep="\t", header=None, names=["angle_rad", "distance_px"])

# Построение полиномиальной аппроксимации 3-й степени
coeffs = np.polyfit(df["angle_rad"], df["distance_px"], 3)
poly = np.poly1d(coeffs)

# Создание данных для графика аппроксимации
x_fit = np.linspace(df["angle_rad"].min(), df["angle_rad"].max(), 300)
y_fit = poly(x_fit)

# Визуализация
plt.figure(figsize=(10, 6))
plt.scatter(df["angle_rad"], df["distance_px"], s=10, color="blue", label="Измерения")
plt.plot(x_fit, y_fit, color="red", linewidth=2, label="Аппроксимация (3 степень)")
plt.title("Зависимость расстояния между маркерами от угла наклона камеры")
plt.xlabel("Угол наклона (рад)")
plt.ylabel("Расстояние между маркерами (пиксели)")
plt.grid(True)
plt.legend()
plt.show()